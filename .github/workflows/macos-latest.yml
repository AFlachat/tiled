name: Compile on latest macOS

on: [push, pull_request]

jobs:
  build:

    runs-on: macOS-latest

    steps:
    - uses: actions/checkout@v1
    - name: install dependencies
      env:
        QT_INSTALL_DIR: ~/Qt
      run: |
        brew install qt
        brew link qt5 --force
        ./dist/install-qt.sh -d ${QT_INSTALL_DIR} --version 4.10.1 qtcreator
    - name: setup qbs
      env:
        QT_INSTALL_DIR: ~/Qt
      run: |
        export PATH=${QT_INSTALL_DIR}/Qt Creator.app/Contents/MacOS:${PATH}
        qbs setup-toolchains --detect
    - name: build
      env:
        QT_INSTALL_DIR: ~/Qt
      run: |
        export PATH=${QT_INSTALL_DIR}/Qt Creator.app/Contents/MacOS:${PATH}
        qbs build profile:xcode
